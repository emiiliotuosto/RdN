This section establishes the correspondence between the denotational
semantics of global types and the operational semantics of local
types.
%
The partial order on the events of a pomset yields an interpretation
of linear executions in terms of \emph{linearisations} similar to
interleaved semantics of concurrent systems.
%
Intuitively a linearisation of a pomset $\apom$ is a sequence of the
events $\esetof \apom$ that preserve the pomset's order
$\leqof \apom$.
%
We show that traces of projections of a global type correspond to
linearisations of its pomset semantics and that for each linearisation
in the pomset semantics there is a system executing a corresponding
trace.
%
We first formalise the notion of linearisation.

Given a pomset $\apom$ and a set of its $\aE \subseteq \esetof \apom$,
a permutation $\ae_1 \cdots \ae_n$ of the events in $\aE$ is a
\emph{linearisation of $\apom$} if
\begin{itemize}
\item $\aE \subseteq \esetof \apom$ preserves $\leqof \apom$ namely
  $\forall 1 \leq i < j \leq n \qst \neg (\ae_j \leqof \apom \ae_i)$
\item each event in $\esetof \apom$ corresponding to an access of an
  interaction is in $\aE$, namely
  if $\ae \in \esetof \apom$ and the tuple type in $\alfof \apom(\ae)$
  if of the form $\arole \cdot \atuple$ then $\ae \in \aE$
\item each output event in $\esetof \apom$ is in $\aE$ and, letting
  $I(\ae)$ be the set of events in $\esetof \apom$ which are labelled
  by inputs of a tuple type matching the one in $\alfof \apom(\ae)$,
  $I(\ae) \cap \aE = \emptyset \iff I(\ae) = \emptyset$
\item accesses in $\ae_1 \cdots \ae_n$ are preceded by a matching
  output, namely ($i$) for each $1 \leq i \leq n$ if $\ae_i$ accesses
  $\atuple$ at $\aloc$ then there is $1 \leq j < i$ such that $\ae_j$
  outputs $\atuple'$ at $\aloc$ with $\atuple' \matches \atuple$ and
  ($ii$) for all $j < h < i$ if $\ae_h$ inputs $\atuple''$ at $\aloc$
  then $\neg (\atuple' \matches \atuple'')$.
\end{itemize}

Fix a sequence
\begin{align}
  \label{eq:gtrace}
  \gtrace  
\end{align}
of labels of events (decorations are immaterial hence omitted in the
following).
%
We say that \eqref{eq:gtrace} is in \emph{normal form} if the defined
names of any two generating labels are disjoint; formally, for all
$1 \leq i \neq j \leq n$
%
\[
  \alabel[]_i \text{ generates
  $\atuple_i$ at $\aloc$ } \land \alabel[]_j \text{ generates
  $\atuple_j$ at $\aloc$ } \implies \dn{\atuple_i} \cap \dn{\atuple_j}
= \emptyset
\]
%
Also, for $1 \leq i < j \leq n$, we say that $\alabel[]_j$ \emph{is in
  the scope of $\alabel[]_i$} if $\alabel[]_i$ generates $\atuple_i$
at $\aloc$ and $\alabel[]_j$ generates $\atuple_j$ at $\aloc$ with
$\atuple_i \matches \atuple_j$ and
$\forall i < h < j \qst \alabel[]_h \text{ generates } \atuple_h
\text{ at } \aloc \implies \neg(\atuple_h \matches \atuple_j)$.
%
Without loss of generality we can assume that each sequence like
\eqref{eq:gtrace} is in normal form (since we can rename all defined
name generated by some $\alabel[]_i$ and the names of the labels
$\alabel[]_j$ in their scope).

Let $\alabel[] \vdash \alpha$ hold iff
\[\begin{array}{l}
  \begin{cases}
    (\alabel[] = \apref[\arole][][@][\aloc] \vee \alabel[] = \apref[\arole][][@][\aloc][.]) & \land\ \alpha = \arole : \arout[][\atuple'][\aloc]
    \\
    \alabel[] = \apref[][\arole][@][\aloc] & \land\ \alpha = \arole : \ain[][\atuple'][\aloc]
    \\
    \alabel[] = \apref[][\arole][@][\aloc][.] & \land\ \alpha = \arole : \ard[][\atuple'][\aloc]
  \end{cases}
    \\
  \text{ and }
  \exists \sigma: \dn{\atuple} \to \fn{\atuple'} \qst \eraseB{\atuple}\sigma = \atuple'
  \end{array}
\]
This definition extends to sequences \eqref{eq:gtrace} with $n \geq 1$
as follows:
$\gtrace \vdash \alpha_1 \cdots \alpha_n$ if
$n = 1$  and $\alabel[]_1 \vdash \ae_1$ or
$n > 1$ and
\[
  \alabel[]_1 \vdash \ae_1 \land  \forall \sigma: \dn{\atuple} \to \fn{\atuple'} \qst \eraseB{\atuple}\sigma = \atuple'
  \implies (\gtrace[2])\sigma \vdash \alpha_2 \cdots \alpha_n
\]
where $\atuple$ is the tuple in $\alabel[]$ and $\atuple'$ is the one in $\alpha_1$.

Given a global type $\aK$, $\envmv$ is a \emph{$\aK$-specification} if
$\arole : \aL \in \envmv$ then $\arole \in \roles{\aK}$ and
$\aL = \proj[@][@][\ ]$.
%
We can now state our correspondence results.
%
\begin{theorem}\label{thm:gt2local}
  Given a well-formed global type $\aK$, for all $\apom \in \ksem \aK$
  there is $\aK$-specification $\envmv$ such that for all
  linearisations $\ae_1 \cdots \ae_n$ of $\apom$ there is
  $\envmv \red[\alpha_1] \cdots \red[\alpha_n]$ such that
  $\alfof \apom(\ae_1) \cdots \alfof \apom(\ae_n) \vdash \alpha_1
  \cdots \alpha_n$.
\end{theorem}
%
\begin{theorem}\label{thm:local2gt}
  
\end{theorem}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
